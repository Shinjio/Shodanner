import requests
from bs4 import BeautifulSoup

#scrapes cvedetails.com for available exploits
def findExploit(cve):

    html = requests.get("https://cvedetails.com/cve/" + cve).text
    bs = BeautifulSoup(html, "lxml")
    exploits = []
    
    metasploit = bs.find("table", {"class" : "metasploit"})
    if metasploit:
        for module in metasploit.find_all("a"):
            exploits.append(module.get("href"))

    references = bs.find(id="vulnrefstable")
    if references:
        for ref in references.find_all("a"):
            r = ref.get("href")
            if "exploit" in r:
                exploits.append(r)

    return exploits
